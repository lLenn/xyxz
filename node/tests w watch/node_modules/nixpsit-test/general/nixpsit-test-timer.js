const process = require("process");
const NS_PER_SEC = 1e9;

class Timer {
	constructor() {
		this.times = {};
	}
	
	track(name) {
		this.times[name] = [process.uptime(), process.hrtime()];
	}
	
	time(name, inNanoSeconds, returnValue) {
		if(inNanoSeconds === undefined) {
			inNanoSeconds = false;
		}
		if(returnValue === undefined) {
			returnValue = false;
		}
		if(this.times[name] !== undefined) {
			var timePassed;
			if(inNanoSeconds) {
				var hrtimeDiff = process.hrtime(this.times[name][1]);
				timePassed = hrtimeDiff[0] * NS_PER_SEC + hrtimeDiff[1];
			} else {
				timePassed = process.uptime() - this.times[name][0];
			}
			if(returnValue === true) {
				return timePassed;
			} else {
				console.log("%s took \x1b[32m%d%s\x1b[0m", name, timePassed, inNanoSeconds===true?"ns":"s");
			}
		}
	}
}

module.exports = new Timer();